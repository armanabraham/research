<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Table of contents</title>

<script src="Data_analysis_and_figures_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="Data_analysis_and_figures_files/bootstrap-2.3.2/css/spacelab.min.css" rel="stylesheet" />
<link href="Data_analysis_and_figures_files/bootstrap-2.3.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
<script src="Data_analysis_and_figures_files/bootstrap-2.3.2/js/bootstrap.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; }
code > span.dt { color: #800000; }
code > span.dv { color: #0000ff; }
code > span.bn { color: #0000ff; }
code > span.fl { color: #800080; }
code > span.ch { color: #ff00ff; }
code > span.st { color: #dd0000; }
code > span.co { color: #808080; font-style: italic; }
code > span.al { color: #00ff00; font-weight: bold; }
code > span.fu { color: #000080; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">Table of contents</h1>
</div>

<div id="TOC">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#data-analysis-of-exp-1-coarse-discrimination">Data analysis of Exp 1 (coarse discrimination)</a></li>
<li><a href="#data-analysis-of-exp-2-fine-discrimination">Data analysis of Exp 2 (fine discrimination)</a></li>
</ul>
</div>

<div id="description" class="section level3">
<h3>Description</h3>
<p>Reproducing data analysis and figures reported in “Low intensity TMS enhances perception of visual stimuli” by Arman Abrahamyan, Colin Clifford, Ehsan Arabzadeh and Justin Harris. You can download all these files, load the project into RStudio and reproduce the analysis by running Data_analysis_and_figures.Rmd file.</p>
<p>Data are provided in RData (Exp1_Exp2_github.RData) and Excel (Exp1_Exp2_github.xslx) formats.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggthemes)
<span class="kw">library</span>(gridExtra)
<span class="kw">library</span>(effsize) <span class="co"># for cohen.d</span>
<span class="kw">library</span>(pastecs) <span class="co"># For stat.desc</span>
<span class="kw">library</span>(afex)
<span class="kw">library</span>(nlme) <span class="co"># For linear mixed-effects modelling, lme</span>
<span class="kw">library</span>(BayesFactor) <span class="co"># Bayes factor analaysis of different experimental designs</span>
## Load Winston Chan&#39;s functions to compute within-subjects error bars
<span class="kw">source</span>(<span class="st">&#39;WithinSbj_StdErrors.R&#39;</span>)
<span class="co"># Load Exp 1 and 2 data </span>
<span class="kw">load</span>(<span class="st">&quot;Exp1_Exp2_github.RData&quot;</span>)
<span class="co"># Order Conditions for plotting convenience</span>
exp1_dataMean$Condition &lt;-<span class="st"> </span><span class="kw">factor</span>(exp1_dataMean$Condition, 
                                  <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;NoTMS&quot;</span>, <span class="st">&quot;ip80&quot;</span>, <span class="st">&quot;ip90&quot;</span>, <span class="st">&quot;60&quot;</span>, <span class="st">&quot;70&quot;</span>, <span class="st">&quot;80&quot;</span>, <span class="st">&quot;90&quot;</span>, <span class="st">&quot;100&quot;</span>))</code></pre>
</div>
<div id="data" class="section level3">
<h3>Data</h3>
<p>Individual subject data for both Exp 1 and 2 are saved as exp1_dataMean and exp2_dataMean, respectively. These are data frames.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(exp1_dataMean, <span class="dv">4</span>)</code></pre>
<pre><code>##   PPT Condition     Th Sensitivity
## 1 S01       100 0.1461       7.957
## 2 S01        60 0.1688       6.004
## 3 S01        70 0.0931      11.156
## 4 S01        80 0.1238       8.292</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(exp2_dataMean, <span class="dv">4</span>)</code></pre>
<pre><code>##   PPT Orientation Condition      Th Sensitivity
## 1 S01       10deg    Contra 0.13196       7.801
## 2 S01       10deg      Ipsi 0.12820       8.029
## 3 S01       10deg     NoTMS 0.17725       5.915
## 4 S01       20deg    Contra 0.07478      13.932</code></pre>
</div>
<div id="data-analysis-of-exp-1-coarse-discrimination" class="section level3">
<h3>Data analysis of Exp 1 (coarse discrimination)</h3>
<div id="quadratic-trend-in-data" class="section level4">
<h4>Quadratic trend in data</h4>
<p>Here we test if visual sensitivity changes as a function of TMS stimulation intensity when subjects discriminated gratings oriented ±45 deg. Due to repeated-measures design, we conducted mixed-modelling analysis wherein subject was a random effect and TMS stimulation intensity was fixed effect. We fitted linear, cubic and quadratic models to the data and found that quadratic fit explains data better than linear or cubic fits (<span class="math">\(\chi^2\)</span>(1)=5.22, <em>p</em>=0.022).</p>
<pre class="sourceCode r"><code class="sourceCode r">################## --- Data analysis of Experiment 1 --- ###################
<span class="co"># Order Conditions for plotting convenience</span>
exp1_dataMean$Condition &lt;-<span class="st"> </span><span class="kw">factor</span>(exp1_dataMean$Condition, 
                                  <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;NoTMS&quot;</span>, <span class="st">&quot;ip80&quot;</span>, <span class="st">&quot;ip90&quot;</span>, <span class="st">&quot;60&quot;</span>, <span class="st">&quot;70&quot;</span>, <span class="st">&quot;80&quot;</span>, <span class="st">&quot;90&quot;</span>, <span class="st">&quot;100&quot;</span>))
<span class="co"># Find out if there is a quadratic trend in the data as a function of TMS intensity</span>
<span class="co"># Select only experimental conditions (exclude NoTMS and ipsilatoral stimulation)</span>
exp1_quadraticFitData &lt;-<span class="st"> </span><span class="kw">droplevels</span>(<span class="kw">subset</span>(exp1_dataMean, !(Condition %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ip80&quot;</span>, <span class="st">&quot;ip90&quot;</span>, <span class="st">&quot;NoTMS&quot;</span>))))
exp1_quadraticFitData &lt;-<span class="st"> </span><span class="kw">within</span>(exp1_quadraticFitData, {CondAsNum &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(Condition)) })
baseline &lt;-<span class="st"> </span><span class="kw">lme</span>(<span class="dt">data=</span>exp1_quadraticFitData, Sensitivity~<span class="dv">1</span>, <span class="dt">random=</span>~<span class="dv">1</span>|PPT/CondAsNum, <span class="dt">method=</span><span class="st">&quot;ML&quot;</span>)
linear &lt;-<span class="st"> </span><span class="kw">update</span>(baseline, .~. +<span class="st"> </span>CondAsNum)
quadratic &lt;-<span class="st"> </span><span class="kw">update</span>(baseline, .~. +<span class="st"> </span>CondAsNum +<span class="st"> </span><span class="kw">I</span>(CondAsNum^<span class="dv">2</span>))
cubic &lt;-<span class="st"> </span><span class="kw">update</span>(baseline, .~. +<span class="st"> </span>CondAsNum +<span class="st"> </span><span class="kw">I</span>(CondAsNum^<span class="dv">2</span>)+<span class="st"> </span><span class="kw">I</span>(CondAsNum^<span class="dv">3</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(baseline, linear, quadratic, cubic)</code></pre>
<pre><code>##           Model df   AIC   BIC logLik   Test L.Ratio p-value
## baseline      1  4 248.6 256.6 -120.3                       
## linear        2  5 250.1 260.2 -120.1 1 vs 2   0.448  0.5035
## quadratic     3  6 246.9 258.9 -117.5 2 vs 3   5.216  0.0224
## cubic         4  7 248.2 262.3 -117.1 3 vs 4   0.679  0.4101</code></pre>
</div>
<div id="sensitivity-change-as-a-function-of-tms-stimulation-figure-1a" class="section level4">
<h4>Sensitivity change as a function of TMS stimulation (Figure 1A)</h4>
<p>This corresponds to Figure 1A in the manuscript. The dashed line shows quadratic trend in the data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute high-res quadratic trend for the plot</span>
fitX &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">CondAsNum=</span><span class="kw">seq</span>(<span class="dv">60</span>,<span class="dv">100</span>, <span class="fl">0.1</span>))
predVals &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>fitX$CondAsNum, <span class="dt">y=</span><span class="kw">predict</span>(quadratic, fitX, <span class="dt">level=</span><span class="dv">0</span>))
<span class="co"># Plot sensitivity from Exp 1 together with quadratic trend</span>
<span class="co"># Summarise data for plotting</span>
exp1_dataForPlot &lt;-<span class="st"> </span><span class="kw">droplevels</span>(<span class="kw">subset</span>(exp1_dataMean, Condition!=<span class="st">&quot;NoTMS&quot;</span>))
exp1_dataForPlot$CoilPosition &lt;-<span class="st"> &quot;Expt&quot;</span>
exp1_dataForPlot$CoilPosition[exp1_dataForPlot$Condition %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ip80&quot;</span>, <span class="st">&quot;ip90&quot;</span>)] &lt;-<span class="st"> &quot;Cntr&quot;</span>
exp1_dataForPlot$CoilPosition &lt;-<span class="st"> </span><span class="kw">as.factor</span>(exp1_dataForPlot$CoilPosition)
## Change the name of the column called &quot;Condition&quot; into &quot;Intensity&quot; cause it is more intuitive
<span class="kw">colnames</span>(exp1_dataForPlot)[<span class="kw">which</span>(<span class="kw">names</span>(exp1_dataForPlot) ==<span class="st"> &quot;Condition&quot;</span>)] &lt;-<span class="st"> &quot;Intensity&quot;</span>
## Now change ip80 and ip90 into 80 and 90
exp1_dataForPlot$Intensity &lt;-<span class="st"> </span><span class="kw">mapvalues</span>(exp1_dataForPlot$Intensity, 
                                        <span class="dt">from =</span> <span class="kw">c</span>(<span class="st">&quot;ip80&quot;</span>, <span class="st">&quot;ip90&quot;</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="st">&quot;80&quot;</span>, <span class="st">&quot;90&quot;</span>))
## Change order of columns (not sure if this is needed, but looks clearer)
exp1_dataForPlot &lt;-<span class="st"> </span><span class="kw">droplevels</span>(exp1_dataForPlot[,<span class="kw">c</span>(<span class="st">&quot;PPT&quot;</span>, <span class="st">&quot;CoilPosition&quot;</span>, <span class="st">&quot;Intensity&quot;</span>, <span class="st">&quot;Th&quot;</span>, <span class="st">&quot;Sensitivity&quot;</span>)])
<span class="co"># Compute means and within-subjects std errors</span>
exp1_qFitForPlot &lt;-<span class="st"> </span><span class="kw">summarySEwithin</span>(exp1_dataForPlot, 
                                    <span class="dt">measurevar=</span><span class="st">&quot;Sensitivity&quot;</span>, 
                                    <span class="dt">withinvars=</span><span class="kw">c</span>(<span class="st">&quot;Intensity&quot;</span>, <span class="st">&quot;CoilPosition&quot;</span>), 
                                    <span class="dt">idvar=</span><span class="st">&quot;PPT&quot;</span>)
gExp1_SensTrend &lt;-<span class="st"> </span><span class="kw">ggplot</span>(exp1_qFitForPlot, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(Intensity)), 
                                                <span class="dt">y=</span>Sensitivity, <span class="dt">color=</span>CoilPosition)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme_few</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="kw">c</span>(<span class="fl">0.19</span>,<span class="fl">0.87</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Stimulation intensity</span><span class="ch">\n</span><span class="st"> (% phosphene threshold)&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Contrast sensitivity&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data=</span>predVals, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y), <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;grey70&quot;</span>, <span class="dt">size=</span>.<span class="dv">3</span>) +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">subset=</span>.(CoilPosition==<span class="st">&quot;Expt&quot;</span>), <span class="kw">aes</span>(<span class="dt">group=</span><span class="dv">1</span>), <span class="dt">color=</span><span class="st">&quot;grey50&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Sensitivity -<span class="st"> </span>se, <span class="dt">ymax =</span> Sensitivity +<span class="st"> </span>se), 
                <span class="dt">width =</span> <span class="fl">0.00</span>, 
                <span class="dt">size =</span> <span class="fl">0.2</span>, 
                <span class="dt">color=</span><span class="st">&quot;grey50&quot;</span>) +<span class="st">   </span><span class="co"># Change &quot;se&quot; to &quot;ci&quot; to plot 95% conf intervals</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">7</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape=</span>CoilPosition), <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">color=</span><span class="st">&quot;grey20&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">19</span>), <span class="dt">name=</span><span class="st">&quot;Coil position&quot;</span>, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Control (Ipsi)&quot;</span>,<span class="st">&quot;Experimental (Contra)&quot;</span>))
<span class="kw">print</span>(gExp1_SensTrend)</code></pre>
<p><img src="Data_analysis_and_figures_files/figure-html/unnamed-chunk-5.pdf" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" width="547.2" /></p>
</div>
<div id="enhancement-in-visual-sensitivity" class="section level4">
<h4>Enhancement in visual sensitivity</h4>
<p>To confirm enhancement in visual sensitivity, here we compare experimental (contralateral) stimulation with control (ipsilateral) stimulation. Because ipsilateral control condition was only tested at two TMS intensities (80 and 90% of PT), we performed a 2x2 repeated measures ANOVA comparing the location of the TMS coil (experimental vs control) and stimulation intensities (80 and 90%).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute 2x2 ANOVA comparing 80% and 90% ipsi and contra conditions</span>
exp1_data8090 &lt;-<span class="st"> </span><span class="kw">droplevels</span>(<span class="kw">subset</span>(exp1_dataForPlot,  Intensity %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;80&quot;</span>, <span class="st">&quot;90&quot;</span>)))
aov8090 &lt;-<span class="st"> </span><span class="kw">aov.car</span>(<span class="dt">data=</span>exp1_data8090, Sensitivity~CoilPosition*Intensity+<span class="kw">Error</span>(PPT/(CoilPosition*Intensity)), <span class="dt">return=</span><span class="st">&quot;Anova&quot;</span>, <span class="dt">args.return=</span><span class="kw">list</span>(<span class="dt">es=</span><span class="st">&quot;pes&quot;</span>))
<span class="kw">nice.anova</span>(aov8090, <span class="dt">es=</span><span class="st">&quot;pes&quot;</span>)</code></pre>
<pre><code>##                   Effect    df  MSE         F  pes     p
## 1           CoilPosition 1, 10 0.76 33.45 ***  .77 .0002
## 2              Intensity 1, 10 1.67      0.10 .009   .76
## 3 CoilPosition:Intensity 1, 10 1.67      0.50  .05   .49</code></pre>
<p>This analysis confirmed that there was a significant main effect for the location of the TMS coil (<em>F</em>(1,10)=33.45, <em>p</em>&lt;0.001, partial <span class="math">\(\eta^2\)</span>=0.77). However, the main effect of stimulation intensity was not significant, indicating no difference between 80 and 90% intensities (<em>F</em>(1,10)=0.10, <em>p</em>=0.76, partial <span class="math">\(\eta^2\)</span>=0.009). Further, there was no interaction between TMS location and stimulation intensity (<em>F</em>(1,10)=0.50, <em>p</em>=0.49, partial <span class="math">\(\eta^2\)</span>=0.05).</p>
<p>We followed up with paired t-tests, which showed significant differences between experimental and control conditions at both 80% and 90% stimulation (80%: <em>Mdiff</em> =1.24, <em>t</em>(10)=2.65, <em>p</em>=0.02, Cohen’s <em>d</em>=0.27; 90%: <em>Mdiff</em> =1.80, <em>t</em>(10)=3.80, <em>p</em>=0.003, Cohen’s <em>d</em>=0.47).</p>
<p><strong>80% contra vs ipsi</strong></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># t-tests</span>
<span class="co"># Compare 80% experimental and control conditions for sensitivity</span>
exp1_data80 &lt;-<span class="st"> </span><span class="kw">droplevels</span>(<span class="kw">subset</span>(exp1_data8090, Intensity==<span class="st">&quot;80&quot;</span>))
exp1_ttest80 &lt;-<span class="st"> </span><span class="kw">t.test</span>(Sensitivity~CoilPosition, <span class="dt">data=</span>exp1_data80, <span class="dt">paired=</span><span class="ot">TRUE</span>)
<span class="co"># Compute effect size r using formula from DSUR (sqrt(t^2/(t^2+df)))</span>
<span class="kw">paste</span>(<span class="st">&#39;r =&#39;</span>, <span class="kw">sqrt</span>(exp1_ttest80$statistic[[<span class="dv">1</span>]]^<span class="dv">2</span>/(exp1_ttest80$statistic[[<span class="dv">1</span>]]^<span class="dv">2</span>+exp1_ttest80$parameter[[<span class="dv">1</span>]])))</code></pre>
<pre><code>## [1] &quot;r = 0.641549923796786&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Cohen&#39;s d is another estimate of effect size. </span>
<span class="kw">cohen.d</span>(<span class="dt">data=</span>exp1_data80, Sensitivity~CoilPosition)</code></pre>
<pre><code>## 
## Cohen&#39;s d
## 
## d estimate: -0.2689 (small)
## 95 percent confidence interval:
##     inf     sup 
## -1.2064  0.6686</code></pre>
<p><strong>90% contra vs ipsi</strong></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 90% experimental vs control </span>
exp1_data90 &lt;-<span class="st"> </span><span class="kw">droplevels</span>(<span class="kw">subset</span>(exp1_data8090, Intensity==<span class="st">&quot;90&quot;</span>))
exp1_ttest90 &lt;-<span class="st"> </span><span class="kw">t.test</span>(Sensitivity~CoilPosition, <span class="dt">data=</span>exp1_data90, <span class="dt">paired=</span><span class="ot">TRUE</span>)
<span class="kw">print</span>(exp1_ttest90)</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  Sensitivity by CoilPosition
## t = -3.808, df = 10, p-value = 0.003438
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.8447 -0.7447
## sample estimates:
## mean of the differences 
##                  -1.795</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&#39;r =&#39;</span>, <span class="kw">sqrt</span>(exp1_ttest90$statistic[[<span class="dv">1</span>]]^<span class="dv">2</span>/(exp1_ttest90$statistic[[<span class="dv">1</span>]]^<span class="dv">2</span>+exp1_ttest90$parameter[[<span class="dv">1</span>]])))</code></pre>
<pre><code>## [1] &quot;r = 0.769350361865236&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cohen.d</span>(<span class="dt">data=</span>exp1_data90, Sensitivity~CoilPosition)</code></pre>
<pre><code>## 
## Cohen&#39;s d
## 
## d estimate: -0.4727 (small)
## 95 percent confidence interval:
##     inf     sup 
## -1.4198  0.4744</code></pre>
<p><strong>Control (ipsi) vs no-TMS</strong></p>
<pre class="sourceCode r"><code class="sourceCode r">## Compare ipsi and no-TMS for
exp1_ipsiNoTMS &lt;-<span class="st"> </span><span class="kw">droplevels</span>(<span class="kw">subset</span>(exp1_dataMean, Condition %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ip80&quot;</span>, <span class="st">&quot;ip90&quot;</span>, <span class="st">&quot;NoTMS&quot;</span>)))
exp1_ipsiNoTMSSens &lt;-<span class="st"> </span><span class="kw">cast</span>(exp1_ipsiNoTMS, PPT~Condition, <span class="dt">value=</span>.(Sensitivity))
exp1_ipsiNoTMSSens &lt;-<span class="st"> </span><span class="kw">ddply</span>(exp1_ipsiNoTMSSens, .(PPT, NoTMS, ip80, ip90), mutate, <span class="dt">ipMean=</span>(ip80+ip90)/<span class="dv">2</span>)
exp1_ttestNoTMS &lt;-<span class="st"> </span><span class="kw">t.test</span>(exp1_ipsiNoTMSSens$NoTMS, exp1_ipsiNoTMSSens$ipMean, <span class="dt">paired=</span><span class="ot">TRUE</span>)
<span class="kw">print</span>(exp1_ttestNoTMS)</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  exp1_ipsiNoTMSSens$NoTMS and exp1_ipsiNoTMSSens$ipMean
## t = 2.624, df = 10, p-value = 0.0254
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.1651 2.0208
## sample estimates:
## mean of the differences 
##                   1.093</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute effect size r</span>
<span class="kw">paste</span>(<span class="st">&#39;r =&#39;</span>, <span class="kw">sqrt</span>(exp1_ttestNoTMS$statistic[[<span class="dv">1</span>]]^<span class="dv">2</span>/(exp1_ttestNoTMS$statistic[[<span class="dv">1</span>]]^<span class="dv">2</span>+exp1_ttestNoTMS$parameter[[<span class="dv">1</span>]])))</code></pre>
<pre><code>## [1] &quot;r = 0.638638128620297&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Cohen&#39;s d</span>
<span class="kw">cohen.d</span>(exp1_ipsiNoTMSSens$NoTMS, exp1_ipsiNoTMSSens$ipMean)</code></pre>
<pre><code>## 
## Cohen&#39;s d
## 
## d estimate: 0.2625 (small)
## 95 percent confidence interval:
##     inf     sup 
## -0.6748  1.1998</code></pre>
</div>
</div>
<div id="data-analysis-of-exp-2-fine-discrimination" class="section level3">
<h3>Data analysis of Exp 2 (fine discrimination)</h3>
<div id="plot-fine-orientation-discrimination" class="section level4">
<h4>Plot fine orientation discrimination</h4>
<p>As can be seen from the plot, dubjects did not show enhancement in visual sensitivity during fine discrimination of grating oriented ±4, ±10 or ±20 deg.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># exclude NoTMS</span>
exp2_dataMeansTMS &lt;-<span class="st"> </span><span class="kw">droplevels</span>(<span class="kw">subset</span>(exp2_dataMean, Condition!=<span class="st">&quot;NoTMS&quot;</span>))
<span class="co"># Column name to be compatible with column names in Exp 1</span>
<span class="kw">colnames</span>(exp2_dataMeansTMS)[<span class="kw">which</span>(<span class="kw">names</span>(exp2_dataMeansTMS) ==<span class="st"> &quot;Condition&quot;</span>)] &lt;-<span class="st"> &quot;CoilPosition&quot;</span>

################## --- Data analysis of combined Experiment 2 --- ###################
<span class="co"># Function to plot Experiment 2 data. Can also plot combined Exp 2 and Exp 1 data </span>
Exp2_PlotByOrientations &lt;-<span class="st"> </span>function(dat, 
                                    <span class="dt">whatToPlot=</span><span class="st">&#39;Sensitivity&#39;</span>,    <span class="co"># Variable on y axis</span>
                                    breaks)                      <span class="co"># y-axis breaks. If not specified, ggplot default is used</span>
{
  datSummary &lt;-<span class="st"> </span><span class="kw">summarySEwithin</span>(dat, <span class="dt">measurevar=</span>whatToPlot, 
                                <span class="dt">withinvars=</span><span class="kw">c</span>(<span class="st">&quot;Orientation&quot;</span>, <span class="st">&quot;CoilPosition&quot;</span>), 
                                <span class="dt">idvar=</span><span class="st">&quot;PPT&quot;</span>)
  <span class="co"># Sort Orientations in ascending order</span>
  datSummary$Orientation &lt;-<span class="st"> </span><span class="kw">factor</span>(datSummary$Orientation, 
                                   <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;4deg&quot;</span>, <span class="st">&quot;10deg&quot;</span>, <span class="st">&quot;20deg&quot;</span>, <span class="st">&quot;45deg@80&quot;</span>, <span class="st">&quot;45deg@90&quot;</span>))
  dodgePos=<span class="kw">position_dodge</span>(<span class="dt">width=</span><span class="fl">0.0</span>)
  g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>datSummary, <span class="kw">aes_string</span>(<span class="dt">x=</span><span class="st">&#39;Orientation&#39;</span>, <span class="dt">y=</span>whatToPlot)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">theme_few</span>() +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes_string</span>(<span class="dt">ymin =</span> <span class="kw">paste</span>(whatToPlot, <span class="st">&#39;- se&#39;</span>), 
                             <span class="dt">ymax =</span> <span class="kw">paste</span>(whatToPlot, <span class="st">&#39;+ se&#39;</span>), 
                             <span class="dt">group=</span><span class="st">&#39;CoilPosition&#39;</span>), 
                  <span class="dt">width =</span> <span class="fl">0.15</span>, 
                  <span class="dt">size =</span> <span class="fl">0.2</span>, 
                  <span class="dt">color=</span><span class="st">&quot;grey50&quot;</span>) +<span class="st">   </span><span class="co"># Change &quot;se&quot; to &quot;ci&quot; to plot 95% conf intervals</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>CoilPosition, <span class="dt">linetype=</span>CoilPosition), <span class="dt">color=</span><span class="st">&quot;grey50&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="fl">6.1</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape=</span>CoilPosition), <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">color=</span><span class="st">&quot;grey20&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;±4&quot;</span>, <span class="st">&quot;±10&quot;</span>, <span class="st">&quot;±20&quot;</span>, <span class="st">&quot;±45</span><span class="ch">\n</span><span class="st">(80% TMS)&quot;</span>, <span class="st">&quot;±45</span><span class="ch">\n</span><span class="st">(90% TMS)&quot;</span>)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) +
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Grating orientation (deg)&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Contrast sensitivity&quot;</span>) +
<span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">19</span>,<span class="dv">1</span>), <span class="dt">name=</span><span class="st">&quot;Coil</span><span class="ch">\n</span><span class="st">position&quot;</span>)
  if (!<span class="kw">missing</span>(breaks)) {
    g &lt;-<span class="st"> </span>g +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> breaks)
  }
  <span class="kw">return</span>(g)
}
<span class="co"># Plot fine orientation discrimination sensitivity for contra and ipsi </span>
exp2_plot &lt;-<span class="st"> </span><span class="kw">Exp2_PlotByOrientations</span>(exp2_dataMeansTMS, <span class="dt">whatToPlot=</span><span class="st">&#39;Sensitivity&#39;</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">8</span>, <span class="dv">18</span>, <span class="dv">2</span>))
<span class="kw">print</span>(exp2_plot)</code></pre>
<p><img src="Data_analysis_and_figures_files/figure-html/unnamed-chunk-10.pdf" title="plot of chunk unnamed-chunk-10" alt="plot of chunk unnamed-chunk-10" width="412.8" /></p>
</div>
<div id="statistics" class="section level4">
<h4>Statistics</h4>
<p>A 2x3 repeated measures ANOVA using TMS stimulation sites (contralateral vs ipsilateral) and orientations (4º, 10º, 20º) as factors showed a significant main effect of orientation (<em>F</em>(1.99, 15.95)=123.86, <em>p</em>&lt;0.01, partial <span class="math">\(\eta^2\)</span>=0.94, Greenhouse–Geisser corrected). However, there was no significant main effect of TMS stimulation site (<em>F</em>(1, 8)=0.13, <em>p</em>=0.73, partial <span class="math">\(\eta^2\)</span>=0.02), nor was there an interaction between stimulation site and grating orientation (<em>F</em>(1.63, 13.04)=0.28, <em>p</em>=0.72, partial <span class="math">\(\eta^2\)</span>=0.03, Greenhouse–Geisser corrected).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute 2x3 repeated-measures ANOVA comparing coil position (ipsi, contra) and orientations (4,10,20)</span>
exp2_aov2by3Sens &lt;-<span class="st"> </span><span class="kw">aov.car</span>(<span class="dt">data=</span>exp2_dataMeansTMS, Sensitivity~CoilPosition*Orientation+<span class="kw">Error</span>(PPT/(CoilPosition*Orientation)), <span class="dt">return=</span><span class="st">&quot;Anova&quot;</span>, <span class="dt">args.return=</span><span class="kw">list</span>(<span class="dt">es=</span><span class="st">&quot;pes&quot;</span>))
<span class="kw">nice.anova</span>(exp2_aov2by3Sens, <span class="dt">es=</span><span class="st">&quot;pes&quot;</span>)</code></pre>
<pre><code>##                     Effect          df  MSE          F pes      p
## 1             CoilPosition        1, 8 5.94       0.13 .02    .73
## 2              Orientation 1.99, 15.95 3.33 123.86 *** .94 &lt;.0001
## 3 CoilPosition:Orientation 1.63, 13.04 2.10       0.28 .03    .72</code></pre>
<p>To assess the strength of the evidence for the null hypothesis that there is no difference between experimental and control TMS stimulation sites, we ran a Bayes factor analysis for paired t-tests with the r scale parameter set to 1.0 to provide equal support for the null and alternative hypotheses (Rouder et al., 2009).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Bayes factor two-samples t-test against the NULL hypothesis that the difference between samples is 0</span>
exp2_meanContraIpsi &lt;-<span class="st"> </span><span class="kw">cast</span>(exp2_dataMeansTMS, PPT~CoilPosition, <span class="dt">value=</span>.(Sensitivity), mean)
<span class="co"># rscale in Bayes factor provides support for the null hypothesis. We will set it 1.0 to </span>
<span class="co"># provide equal support for the null and alternative hypotheses (Rouder et al., 2009)</span>
exp2_contraIpsiBF &lt;-<span class="st"> </span><span class="kw">ttestBF</span>(<span class="dt">x=</span>exp2_meanContraIpsi$Contra, <span class="dt">y=</span>exp2_meanContraIpsi$Ipsi, <span class="dt">paired =</span> <span class="ot">TRUE</span>, <span class="dt">rscale=</span><span class="fl">1.0</span>)
<span class="co"># Get likelihood of NULL hypothesis over difference between contra and ipsi</span>
<span class="dv">1</span>/exp2_contraIpsiBF</code></pre>
<pre><code>## Bayes factor analysis
## --------------
## [1] Null, mu=0 : 3.868 ±0%
## 
## Against denominator:
##   Alternative, r = 1, mu =/= 0 
## ---
## Bayes factor type: BFoneSample, JZS</code></pre>
<p>The Bayes factor analysis shows that it is 3.9 times more likely that there is no effect of TMS during fine orientation discrimination than there is some effect, which is within the range of substantial evidence (Jeffreys, 1961).</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
